<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Megalophone</title>
	<meta name="description" content="An educational and live in-browser synth" />
</head>

<body>

	<h1>Megalophone</h1>
	<button>Play</button>

	<script type="module">
		import Megalophone from './_js/megalophone/megalophone.js';
		function* notes() {
			while (true) {
				yield 110;
				yield 220;
				yield 110 * 1.05;
			}
		}
		document.querySelector('button').addEventListener('click', async e => {
			const gen = notes();
			const ctx = new AudioContext();
			const periodMsec = 250;
			const tick = function () {
				setTimeout(() => {
					new Megalophone(ctx).play(gen.next().value, periodMsec / 1000.0);
					tick();
				}, periodMsec);
			};
			tick();
		});
	</script>
</body>

</html>